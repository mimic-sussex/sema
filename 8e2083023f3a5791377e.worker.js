!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r(r.s=3)}([function(t,e,r){var n,i;n=this,i=function(){function t(e,r,n){return this.id=++t.highestId,this.name=e,this.symbols=r,this.postprocess=n,this}function e(t,e,r,n){this.rule=t,this.dot=e,this.reference=r,this.data=[],this.wantedBy=n,this.isComplete=this.dot===t.symbols.length}function r(t,e){this.grammar=t,this.index=e,this.states=[],this.wants={},this.scannable=[],this.completed={}}function n(t,e){this.rules=t,this.start=e||this.rules[0].name;var r=this.byName={};this.rules.forEach((function(t){r.hasOwnProperty(t.name)||(r[t.name]=[]),r[t.name].push(t)}))}function i(){this.reset("")}function o(t,e,o){if(t instanceof n){var s=t;o=e}else s=n.fromCompiled(t,e);for(var a in this.grammar=s,this.options={keepHistory:!1,lexer:s.lexer||new i},o||{})this.options[a]=o[a];this.lexer=this.options.lexer,this.lexerState=void 0;var l=new r(s,0);this.table=[l],l.wants[s.start]=[],l.predict(s.start),l.process(),this.current=0}return t.highestId=0,t.prototype.toString=function(t){function e(t){return t.literal?JSON.stringify(t.literal):t.type?"%"+t.type:t.toString()}var r=void 0===t?this.symbols.map(e).join(" "):this.symbols.slice(0,t).map(e).join(" ")+" ● "+this.symbols.slice(t).map(e).join(" ");return this.name+" → "+r},e.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},e.prototype.nextState=function(t){var r=new e(this.rule,this.dot+1,this.reference,this.wantedBy);return r.left=this,r.right=t,r.isComplete&&(r.data=r.build(),r.right=void 0),r},e.prototype.build=function(){var t=[],e=this;do{t.push(e.right.data),e=e.left}while(e.left);return t.reverse(),t},e.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,o.fail))},r.prototype.process=function(t){for(var e=this.states,r=this.wants,n=this.completed,i=0;i<e.length;i++){var s=e[i];if(s.isComplete){if(s.finish(),s.data!==o.fail){for(var a=s.wantedBy,l=a.length;l--;){var u=a[l];this.complete(u,s)}if(s.reference===this.index){var h=s.rule.name;(this.completed[h]=this.completed[h]||[]).push(s)}}}else{if("string"!=typeof(h=s.rule.symbols[s.dot])){this.scannable.push(s);continue}if(r[h]){if(r[h].push(s),n.hasOwnProperty(h)){var f=n[h];for(l=0;l<f.length;l++){var c=f[l];this.complete(s,c)}}}else r[h]=[s],this.predict(h)}}},r.prototype.predict=function(t){for(var r=this.grammar.byName[t]||[],n=0;n<r.length;n++){var i=r[n],o=this.wants[t],s=new e(i,0,this.index,o);this.states.push(s)}},r.prototype.complete=function(t,e){var r=t.nextState(e);this.states.push(r)},n.fromCompiled=function(e,r){var i=e.Lexer;e.ParserStart&&(r=e.ParserStart,e=e.ParserRules);var o=new n(e=e.map((function(e){return new t(e.name,e.symbols,e.postprocess)})),r);return o.lexer=i,o},i.prototype.reset=function(t,e){this.buffer=t,this.index=0,this.line=e?e.line:1,this.lastLineBreak=e?-e.col:0},i.prototype.next=function(){if(this.index<this.buffer.length){var t=this.buffer[this.index++];return"\n"===t&&(this.line+=1,this.lastLineBreak=this.index),{value:t}}},i.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},i.prototype.formatError=function(t,e){var r=this.buffer;if("string"==typeof r){var n=r.indexOf("\n",this.index);-1===n&&(n=r.length);var i=r.substring(this.lastLineBreak,n),o=this.index-this.lastLineBreak;return e+=" at line "+this.line+" col "+o+":\n\n",e+="  "+i+"\n",e+="  "+Array(o).join(" ")+"^"}return e+" at index "+(this.index-1)},o.fail={},o.prototype.feed=function(t){var e,n=this.lexer;for(n.reset(t,this.lexerState);e=n.next();){var o=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var s=this.current+1,a=new r(this.grammar,s);this.table.push(a);for(var l=void 0!==e.text?e.text:e.value,u=n.constructor===i?e.value:e,h=o.scannable,f=h.length;f--;){var c=h[f],p=c.rule.symbols[c.dot];if(p.test?p.test(u):p.type?p.type===e.type:p.literal===l){var d=c.nextState({data:u,token:e,isToken:!0,reference:s-1});a.states.push(d)}}if(a.process(),0===a.states.length){var y=new Error(this.reportError(e));throw y.offset=this.current,y.token=e,y}this.options.keepHistory&&(o.lexerState=n.save()),this.current++}return o&&(this.lexerState=n.save()),this.results=this.finish(),this},o.prototype.reportError=function(t){var e=[],r=(t.type?t.type+" token: ":"")+JSON.stringify(void 0!==t.value?t.value:t);e.push(this.lexer.formatError(t,"Syntax error")),e.push("Unexpected "+r+". Instead, I was expecting to see one of the following:\n");var n=this.table.length-2;return this.table[n].states.filter((function(t){var e=t.rule.symbols[t.dot];return e&&"string"!=typeof e})).map((function(t){return this.buildFirstStateStack(t,[])}),this).forEach((function(t){var r=t[0],n=r.rule.symbols[r.dot],i=this.getSymbolDisplay(n);e.push("A "+i+" based on:"),this.displayStateStack(t,e)}),this),e.push(""),e.join("\n")},o.prototype.displayStateStack=function(t,e){for(var r,n=0,i=0;i<t.length;i++){var o=t[i],s=o.rule.toString(o.dot);s===r?n++:(n>0&&e.push("    ⬆ ︎"+n+" more lines identical to this"),n=0,e.push("    "+s)),r=s}},o.prototype.getSymbolDisplay=function(t){var e=typeof t;if("string"===e)return t;if("object"===e&&t.literal)return JSON.stringify(t.literal);if("object"===e&&t instanceof RegExp)return"character matching "+t;if("object"===e&&t.type)return t.type+" token";throw new Error("Unknown symbol type: "+t)},o.prototype.buildFirstStateStack=function(t,e){if(-1!==e.indexOf(t))return null;if(0===t.wantedBy.length)return[t];var r=t.wantedBy[0],n=[t].concat(e),i=this.buildFirstStateStack(r,n);return null===i?null:[t].concat(i)},o.prototype.save=function(){var t=this.table[this.current];return t.lexerState=this.lexerState,t},o.prototype.restore=function(t){var e=t.index;this.current=e,this.table[e]=t,this.table.splice(e+1),this.lexerState=t.lexerState,this.results=this.finish()},o.prototype.rewind=function(t){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[t])},o.prototype.finish=function(){var t=[],e=this.grammar.start;return this.table[this.table.length-1].states.forEach((function(r){r.rule.name===e&&r.dot===r.rule.symbols.length&&0===r.reference&&r.data!==o.fail&&t.push(r)})),t.map((function(t){return t.data}))},{Parser:o,Grammar:n,Rule:t}},t.exports?t.exports=i():n.nearley=i()},function(t,e,r){var n,i,o;i=[],void 0===(o="function"==typeof(n=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,r="boolean"==typeof(new RegExp).sticky;function n(t){return t&&"[object RegExp]"===e.call(t)}function i(t){return t&&"object"==typeof t&&!n(t)&&!Array.isArray(t)}function o(t){return"("+t+")"}function s(t){return t.length?"(?:"+t.map((function(t){return"(?:"+t+")"})).join("|")+")":"(?!)"}function a(t){if("string"==typeof t)return"(?:"+t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+")";if(n(t)){if(t.ignoreCase)throw new Error("RegExp /i flag not allowed");if(t.global)throw new Error("RegExp /g flag is implied");if(t.sticky)throw new Error("RegExp /y flag is implied");if(t.multiline)throw new Error("RegExp /m flag is implied");return t.source}throw new Error("Not a pattern: "+t)}function l(e,r){if(i(r)||(r={match:r}),r.include)throw new Error("Matching rules cannot also include states");var o={defaultType:e,lineBreaks:!!r.error||!!r.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var s in r)t.call(r,s)&&(o[s]=r[s]);if("string"==typeof o.type&&e!==o.type)throw new Error("Type transform cannot be a string (type '"+o.type+"' for token '"+e+"')");var a=o.match;return o.match=Array.isArray(a)?a:a?[a]:[],o.match.sort((function(t,e){return n(t)&&n(e)?0:n(e)?-1:n(t)?1:e.length-t.length})),o}function u(t){return Array.isArray(t)?function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];if(n.include)for(var i=[].concat(n.include),o=0;o<i.length;o++)e.push({include:i[o]});else{if(!n.type)throw new Error("Rule has no type: "+JSON.stringify(n));e.push(l(n.type,n))}}return e}(t):function(t){for(var e=Object.getOwnPropertyNames(t),r=[],n=0;n<e.length;n++){var o=e[n],s=t[o],a=[].concat(s);if("include"!==o){var u=[];a.forEach((function(t){i(t)?(u.length&&r.push(l(o,u)),r.push(l(o,t)),u=[]):u.push(t)})),u.length&&r.push(l(o,u))}else for(var h=0;h<a.length;h++)r.push({include:a[h]})}return r}(t)}var h=l("error",{lineBreaks:!0,shouldThrow:!0});function f(t,e){for(var i=null,l=Object.create(null),u=!0,f=null,c=[],p=[],d=0;d<t.length;d++)t[d].fallback&&(u=!1);for(d=0;d<t.length;d++){var y=t[d];if(y.include)throw new Error("Inheritance is not allowed in stateless lexers");if(y.error||y.fallback){if(i)throw!y.fallback==!i.fallback?new Error("Multiple "+(y.fallback?"fallback":"error")+" rules not allowed (for token '"+y.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+y.defaultType+"')");i=y}var g=y.match.slice();if(u)for(;g.length&&"string"==typeof g[0]&&1===g[0].length;)l[g.shift().charCodeAt(0)]=y;if(y.pop||y.push||y.next){if(!e)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+y.defaultType+"')");if(y.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+y.defaultType+"')")}if(0!==g.length){u=!1,c.push(y);for(var _=0;_<g.length;_++){var v=g[_];if(n(v))if(null===f)f=v.unicode;else if(f!==v.unicode&&!1===y.fallback)throw new Error("If one rule is /u then all must be")}var m=s(g.map(a)),w=new RegExp(m);if(w.test(""))throw new Error("RegExp matches empty string: "+w);if(new RegExp("|"+m).exec("").length-1>0)throw new Error("RegExp has capture groups: "+w+"\nUse (?: … ) instead");if(!y.lineBreaks&&w.test("\n"))throw new Error("Rule should declare lineBreaks: "+w);p.push(o(m))}}var b=i&&i.fallback,x=r&&!b?"ym":"gm",E=r||b?"":"|";return!0===f&&(x+="u"),{regexp:new RegExp(s(p)+E,x),groups:c,fast:l,error:i||h}}function c(t,e,r){var n=t&&(t.push||t.next);if(n&&!r[n])throw new Error("Missing state '"+n+"' (in token '"+t.defaultType+"' of state '"+e+"')");if(t&&t.pop&&1!=+t.pop)throw new Error("pop must be 1 (in token '"+t.defaultType+"' of state '"+e+"')")}var p=function(t,e){this.startState=e,this.states=t,this.buffer="",this.stack=[],this.reset()};p.prototype.reset=function(t,e){return this.buffer=t||"",this.index=0,this.line=e?e.line:1,this.col=e?e.col:1,this.queuedToken=e?e.queuedToken:null,this.queuedThrow=e?e.queuedThrow:null,this.setState(e?e.state:this.startState),this.stack=e&&e.stack?e.stack.slice():[],this},p.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedThrow:this.queuedThrow}},p.prototype.setState=function(t){if(t&&this.state!==t){this.state=t;var e=this.states[t];this.groups=e.groups,this.error=e.error,this.re=e.regexp,this.fast=e.fast}},p.prototype.popState=function(){this.setState(this.stack.pop())},p.prototype.pushState=function(t){this.stack.push(this.state),this.setState(t)};var d=r?function(t,e){return t.exec(e)}:function(t,e){var r=t.exec(e);return 0===r[0].length?null:r};function y(){return this.value}if(p.prototype._getGroup=function(t){for(var e=this.groups.length,r=0;r<e;r++)if(void 0!==t[r+1])return this.groups[r];throw new Error("Cannot find token type for matched text")},p.prototype.next=function(){var t=this.index;if(this.queuedGroup){var e=this._token(this.queuedGroup,this.queuedText,t);return this.queuedGroup=null,this.queuedText="",e}var r=this.buffer;if(t!==r.length){if(s=this.fast[r.charCodeAt(t)])return this._token(s,r.charAt(t),t);var n=this.re;n.lastIndex=t;var i=d(n,r),o=this.error;if(null==i)return this._token(o,r.slice(t,r.length),t);var s=this._getGroup(i),a=i[0];return o.fallback&&i.index!==t?(this.queuedGroup=s,this.queuedText=a,this._token(o,r.slice(t,i.index),t)):this._token(s,a,t)}},p.prototype._token=function(t,e,r){var n=0;if(t.lineBreaks){var i=/\n/g,o=1;if("\n"===e)n=1;else for(;i.exec(e);)n++,o=i.lastIndex}var s={type:"function"==typeof t.type&&t.type(e)||t.defaultType,value:"function"==typeof t.value?t.value(e):e,text:e,toString:y,offset:r,lineBreaks:n,line:this.line,col:this.col},a=e.length;if(this.index+=a,this.line+=n,0!==n?this.col=a-o+1:this.col+=a,t.shouldThrow)throw new Error(this.formatError(s,"invalid syntax"));return t.pop?this.popState():t.push?this.pushState(t.push):t.next&&this.setState(t.next),s},"undefined"!=typeof Symbol&&Symbol.iterator){var g=function(t){this.lexer=t};g.prototype.next=function(){var t=this.lexer.next();return{value:t,done:!t}},g.prototype[Symbol.iterator]=function(){return this},p.prototype[Symbol.iterator]=function(){return new g(this)}}return p.prototype.formatError=function(t,e){if(null==t){var r=this.buffer.slice(this.index);t={text:r,offset:this.index,lineBreaks:-1===r.indexOf("\n")?0:1,line:this.line,col:this.col}}var n=Math.max(0,t.offset-t.col+1),i=t.lineBreaks?t.text.indexOf("\n"):t.text.length,o=this.buffer.substring(n,t.offset+i);return e+=" at line "+t.line+" col "+t.col+":\n\n",e+="  "+o+"\n",e+="  "+Array(t.col).join(" ")+"^"},p.prototype.clone=function(){return new p(this.states,this.state)},p.prototype.has=function(t){return!0},{compile:function(t){var e=f(u(t));return new p({start:e},"start")},states:function(t,e){var r=t.$all?u(t.$all):[];delete t.$all;var n=Object.getOwnPropertyNames(t);e||(e=n[0]);for(var i=Object.create(null),o=0;o<n.length;o++){var s=n[o];i[s]=u(t[s]).concat(r)}for(o=0;o<n.length;o++){s=n[o];for(var a=i[s],l=Object.create(null),h=0;h<a.length;h++){var d=a[h];if(d.include){var y=[h,1];if(d.include!==s&&!l[d.include]){l[d.include]=!0;var g=i[d.include];if(!g)throw new Error("Cannot include nonexistent state '"+d.include+"' (in state '"+s+"')");for(var _=0;_<g.length;_++){var v=g[_];-1===a.indexOf(v)&&y.push(v)}}a.splice.apply(a,y),h--}}}var m=Object.create(null);for(o=0;o<n.length;o++)s=n[o],m[s]=f(i[s],!0);for(o=0;o<n.length;o++){var w=n[o],b=m[w],x=b.groups;for(h=0;h<x.length;h++)c(x[h],w,m);var E=Object.getOwnPropertyNames(b.fast);for(h=0;h<E.length;h++)c(b.fast[E[h]],w,m)}return new p(m,e)},error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:function(t){for(var e=Object.create(null),r=Object.create(null),n=Object.getOwnPropertyNames(t),i=0;i<n.length;i++){var o=n[i],s=t[o];(Array.isArray(s)?s:[s]).forEach((function(t){if((r[t.length]=r[t.length]||[]).push(t),"string"!=typeof t)throw new Error("keyword must be string (in keyword '"+o+"')");e[t]=o}))}function a(t){return JSON.stringify(t)}var l="";for(var u in l+="switch (value.length) {\n",r){var h=r[u];l+="case "+u+":\n",l+="switch (value) {\n",h.forEach((function(t){var r=e[t];l+="case "+a(t)+": return "+a(r)+"\n"})),l+="}\n"}return l+="}\n",Function("value",l)}}})?n.apply(e,i):n)||(t.exports=o)},function(t,e){t.exports={num:function(t){return{"@num":{value:t}}},str:function(t){return{"@string":t}},synth:function(t,e){return{"@sigp":{"@params":e,"@func":{value:t}}}},setvar:function(t,e){return{"@setvar":{"@varname":t,"@varvalue":e}}},getvar:function(t){return{"@getvar":t}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var nearley__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),nearley__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(nearley__WEBPACK_IMPORTED_MODULE_0__),moo__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),moo__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(moo__WEBPACK_IMPORTED_MODULE_1__),_intermediateLanguage_sema__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2),_intermediateLanguage_sema__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_intermediateLanguage_sema__WEBPACK_IMPORTED_MODULE_2__);function getParserModuleExports(source){let moo=moo__WEBPACK_IMPORTED_MODULE_1___default.a,sema=_intermediateLanguage_sema__WEBPACK_IMPORTED_MODULE_2___default.a,module={exports:""};return eval(source),module.exports}const clone=t=>JSON.parse(JSON.stringify(t));onmessage=function(t){if(void 0!==t.data&&0!=t.data.length&&"parse"===t.data.type)try{let e=[];const{liveCodeSource:r,parserSource:n}=t.data;let i=new nearley__WEBPACK_IMPORTED_MODULE_0___default.a.Parser(getParserModuleExports(n));i.feed(r),e=JSON.parse(JSON.stringify(i.results)),console.log("DEBUG:workerParser:onmessage:parserOut"),console.log(e),postMessage({parserOutputs:clone(i.results),parserResults:clone(i.results)})}catch(t){console.log("DEBUG:workerParser:onmessage:catch"),console.dir(t.message),postMessage(t.message)}}}]);